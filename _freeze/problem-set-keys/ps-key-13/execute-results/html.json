{
  "hash": "c4c9482231977eaba6b4e54a06d33ef9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Problem Set Stats Bootcamp - class 13\"\nsubtitle: \"Hypothesis Testing\"\nauthor: \"Neelanjan Mukherjee\"\neditor: visual\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rstatix)\nlibrary(ggpubr)\nlibrary(gt)\nlibrary(janitor)\nlibrary(here)\nlibrary(broom)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbiochem <- read_tsv(\n  \"http://mtweb.cs.ucl.ac.uk/HSMICE/PHENOTYPES/Biochemistry.txt\",\n  show_col_types = FALSE\n) |>\n  janitor::clean_names()\n\n# simplify names a bit more\ncolnames(biochem) <- gsub(\n  pattern = \"biochem_\",\n  replacement = \"\",\n  colnames(biochem)\n)\n\n# we are going to simplify this a bit and only keep some columns\nkeep <- colnames(biochem)[c(1, 6, 9, 14, 15, 24:28)]\nbiochem <- biochem[, keep]\n\n# get weights for each individual mouse\n# careful: did not come with column names\nweight <- read_tsv(\n  \"http://mtweb.cs.ucl.ac.uk/HSMICE/PHENOTYPES/weight\",\n  col_names = F,\n  show_col_types = FALSE\n)\n\n# add column names\ncolnames(weight) <- c(\"subject_name\", \"weight\")\n\n# add weight to biochem table and get rid of NAs\n# rename gender to sex\nb <- inner_join(biochem, weight, by = \"subject_name\") |>\n  na.omit() |>\n  rename(sex = gender)\n```\n:::\n\n\n## Problem \\# 1\n\nIs there an association between mouse calcium and sodium levels?\n\n### 1. Make a scatterplot to inspect variable --- (2 pts)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggscatter(\n  data = b,\n  y = \"calcium\",\n  x = \"sodium\"\n)\n```\n\n::: {.cell-output-display}\n![](ps-key-13_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### 2. Are they normal (enough)? --- (1 pts)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggqqplot(data = b, x = \"calcium\")\n```\n\n::: {.cell-output-display}\n![](ps-key-13_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nb |> shapiro_test(calcium)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  variable statistic         p\n  <chr>        <dbl>     <dbl>\n1 calcium      0.995 0.0000108\n```\n\n\n:::\n\n```{.r .cell-code}\nggqqplot(data = b, x = \"sodium\")\n```\n\n::: {.cell-output-display}\n![](ps-key-13_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nb |> shapiro_test(sodium)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  variable statistic          p\n  <chr>        <dbl>      <dbl>\n1 sodium       0.995 0.00000432\n```\n\n\n:::\n:::\n\n\nWhich test will you use and why?\n\n> I will use the Pearson since the qqplots look ok and there are \\~1700 observations. Spearman is fine too - especially since sodium looks a little like an integer and not continuous.\n\n### 3. Declare null hypothesis $\\mathcal{H}_0$ --- (1 pts)\n\n$\\mathcal{H}_0$ is that there is no dependency/association between $calcium$ and $sodium$\n\n### 4. Calculate and plot the correlation on a scatterplot --- (2 pts)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggscatter(\n  data = b,\n  y = \"calcium\",\n  x = \"sodium\"\n) +\n  stat_cor(\n    method = \"pearson\",\n    label.x = 110,\n    label.y = 2.4\n  )\n```\n\n::: {.cell-output-display}\n![](ps-key-13_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Problem \\# 2\n\n## Do mouse calcium levels explain mouse sodium levels? If so, to what extent?\n\nUse a linear model to do the following:\n\n### 1. Specify the Response and Explanatory variables --- (2 pts)\n\n> The response variable y is sodium The explantory variable x is calcium\n\n### 2. Declare the null hypothesis --- (1 pts)\n\n> The null hypothesis is calcium levels do not explain/predict sodium levels.\n\n### 3. Use the `lm` function to create a fit (linear model) --- (1 pts)\n\nalso save the slope and intercept for later\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- lm(formula = sodium ~ 1 + calcium, data = b)\n\n\nint <- tidy(fit)[1, 2]\nslope <- tidy(fit)[2, 2]\n```\n:::\n\n\n### 4. Add residuals to the data and create a plot visualizing the residuals --- (1 pts)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nb_fit <- augment(fit, data = b)\n\navg_sod <- mean(b$sodium)\n\nggplot(\n  data = b_fit,\n  aes(x = calcium, y = sodium)\n) +\n  geom_point(size = 1, aes(color = .resid)) +\n  geom_abline(\n    intercept = pull(int),\n    slope = pull(slope),\n    col = \"red\"\n  ) +\n  scale_color_gradient2(\n    low = \"blue\",\n    mid = \"black\",\n    high = \"yellow\"\n  ) +\n  geom_segment(\n    aes(\n      xend = calcium,\n      yend = .fitted\n    ),\n    alpha = .1\n  ) + # plot line representing residuals\n  theme_linedraw()\n```\n\n::: {.cell-output-display}\n![](ps-key-13_files/figure-html/augment and viz-1.png){fig-alt='Description of the plot - PLEASE FILL IN' width=672}\n:::\n:::\n\n\n### 5. Calculate the $R^2$ and compare to $R^2$ from fit --- (2 pts)\n\n$R^2 = 1 - \\displaystyle \\frac {SS_{fit}}{SS_{null}}$\n\n$SS_{fit} = \\sum_{i=1}^{n} (data - line)^2 = \\sum_{i=1}^{n} (y_{i} - (\\beta_0 \\cdot 1+ \\beta_1 \\cdot x)^2$\n\n$SS_{null}$ --- sum of squared errors around the mean of $y$\n\n$SS_{null} = \\sum_{i=1}^{n} (data - mean)^2 = \\sum_{i=1}^{n} (y_{i} - \\overline{y})^2$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nss_fit <- sum(b_fit$.resid^2)\nss_null <- sum(\n  (b_fit$sodium - avg_sod)^2\n)\nrsq <- 1 - ss_fit / ss_null\nglance(fit) |> select(r.squared)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  r.squared\n      <dbl>\n1     0.684\n```\n\n\n:::\n:::\n\n\n### 6. Using $R^2$, describe the extent to which calcium explains sodium levels --- (2 pts)\n\n> $calcium$ explains \\~68% of variation in $sodium$ levels\n\n### 7. Report (do not calculate) the $p-value$ and your decision on the null --- (1 pts)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit |>\n  glance() |>\n  select(p.value)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  p.value\n    <dbl>\n1       0\n```\n\n\n:::\n:::\n\n\n> The null hypothesis is calcium levels do not explain/predict sodium levels IS NOT SUPPORTED\n\nCalcium levels to predict sodium levels.\n\n## Problem \\# 3\n\nWhat is the association between mouse weight and age levels for different sexes?\n\n### 1. Calculate the pearson correlation coefficient between weight and age for females and males --- (2 pts)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nb |>\n  group_by(factor(sex)) |>\n  cor_test(weight, age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 9\n  `factor(sex)` var1   var2    cor statistic        p conf.low conf.high method \n  <fct>         <chr>  <chr> <dbl>     <dbl>    <dbl>    <dbl>     <dbl> <chr>  \n1 F             weight age    0.21      6.30 4.67e-10    0.143     0.269 Pearson\n2 M             weight age    0.37     12.0  1.22e-30    0.314     0.427 Pearson\n```\n\n\n:::\n:::\n\n\n### 2. Describe your observations --- (2 pts)\n\n> The relationship between weight and age is stronger for males than it is for females.\n",
    "supporting": [
      "ps-key-13_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}