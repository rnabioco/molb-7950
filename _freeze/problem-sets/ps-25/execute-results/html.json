{
  "hash": "d4f347e1bd5e68a00bc9b007974fad0d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"RNA Block - Problem Set 25\"\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(cowplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'cowplot'\n\nThe following object is masked from 'package:lubridate':\n\n    stamp\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nhere() starts at /Users/jayhesselberth/devel/rnabioco/molb-7950\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggrepel)\nlibrary(pheatmap)\nlibrary(RColorBrewer)\n```\n:::\n\n\n## Problem Set\n\nTotal points: 20. Q1 - 10 pts, Q2 - 10 points each.\n\nExercises: Take rMATS SE output, apply filters, and make a volcano plot. Also, make a heatmap of the significant PSI for each sample using all replicates. NOTE: this analysis will be performed for the **mutually exclusive exons**.\n\n# Exercises\n\nWe worked with an rMATS output file from an experiment in which mouse embryonic stem cells had been treated with either an shRNA against RBFOX2 or a control, nontargeting shRNA. We applied filters to remove any event from consideration in which the number of informative reads for that event (IJC + SJC) was less than 20 in **any** sample.\n\n# Q1 make volcano plot\n\nRead in the rMATS output for **mutually exclusive exons**. Apply a new read coverage filter such that any event with less than **10** informative junction reads in **any** sample is removed. Then make a volcano plot where each dot is an event, the x-axis is the difference in PSI between the two conditions (aka `IncLevelDifference`) and the y axis is -log10 of the `FDR`. Color dots that pass a significance threshold (FDR \\< 0.05) in red. Label the 4 most significant events (i.e. 4 lowest FDR values) with the name of the gene they are in.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in table\n\n\n# Split the replicate read counts that are separated by commas into different columns\n\n\n# filter events (reads >= 10)\n\n\n# Separate the inclusion levels for each sample and replicte (you will need this later)\n\n\n\n# Add another column to table that says whether or not this event is significant (FDR < 0.05)\n\n\n\n\n# Volcano Plot with sig events in red\n```\n:::\n\n\n![explosion](/img/block-rna/psi_volcano.png)\n\n# Exercise 2\n\nTake your skipped exon data and make a heatmap where the rows are events, columns are samples (each replicate separately, 4 replicates per condition), and the color of the cell is a scaled PSI value. Only plot significant (FDR \\< 0.05) events.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter for those that are significant (FDR < 0.05) and only keep columns with inclusion differences\n\n\n# Plot with pheatmap(), using scale = 'row' to plot scaled PSI values\n```\n:::\n\n\n![you don't need to have the gene symbols](/img/block-rna/psi_heatmap.png)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}