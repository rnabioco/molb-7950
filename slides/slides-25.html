<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-54c8f25464f32f8783bd446cee98020d.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="Neel Mukherjee">
  <meta name="dcterms.date" content="2025-10-05">
  <title>MOLB 7950 – Alternative splicing</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #97947a;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #97947a;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2; background-color: #2b2b2b; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #dcc6e0; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #ffd700; } /* Attribute */
    code span.bn { color: #dcc6e0; } /* BaseN */
    code span.bu { color: #f5ab35; } /* BuiltIn */
    code span.cf { color: #ffa07a; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffa07a; } /* Constant */
    code span.co { color: #d4d0ab; } /* Comment */
    code span.cv { color: #d4d0ab; font-style: italic; } /* CommentVar */
    code span.do { color: #d4d0ab; font-style: italic; } /* Documentation */
    code span.dt { color: #dcc6e0; } /* DataType */
    code span.dv { color: #dcc6e0; } /* DecVal */
    code span.er { color: #dcc6e0; } /* Error */
    code span.ex { color: #ffd700; } /* Extension */
    code span.fl { color: #f5ab35; } /* Float */
    code span.fu { color: #ffd700; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; } /* Keyword */
    code span.op { color: #00e0e0; } /* Operator */
    code span.ot { color: #ffa07a; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.sc { color: #00e0e0; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #f5ab35; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #d4d0ab; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-8fafb62820c35118272e29c1027a293f.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Alternative splicing – MOLB 7950">
<meta property="og:site_name" content="MOLB 7950">
<meta name="twitter:title" content="Alternative splicing – MOLB 7950">
<meta name="twitter:image" content="https://rnabioco.github.io/molb-7950/slides/images/twitter-card.png">
<meta name="twitter:creator" content="@rnabioco">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Alternative splicing</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Neel Mukherjee 
</div>
        <p class="quarto-title-affiliation">
            RNA Bioscience Initiative | CU Anschutz
          </p>
    </div>
</div>

  <p class="date">2025-10-05</p>
</section>
<section id="overview" class="slide level2 smaller">
<h2>Overview</h2>
<p>In this lecture, we are going focus on analyzing the regulation of alternative splicing using RNAseq approaches.As we learned last week, <code>salmon</code> quantifies a fastq file of sequencing reads against a fasta file of all transcripts present in the sample. At the end of this analysis, we end up with quantifications for each transcript in our fasta file. However, for splicing you may be able to see how this strategy may need to be tweaked. <code>salmon</code> gave us transcript-level data, but for looking at splicing, we often want to measure how the inclusion of individual <strong>exons</strong> within transcripts differs between conditions. Thus, transcript-level quantifications are not directly useful here.</p>
<blockquote>
<p>Small aside: Actually, transcript level quantifications could work, because you could ask how the relative abundances of two different transcripts (one that has the exon in question and one that doesn’t) vary across conditions. See also <code>suppa2</code>.</p>
</blockquote>
</section>
<section id="split-alignments" class="slide level2 smaller">
<h2>Split alignments</h2>
<p>We need exon-level quantifications. So we want to count reads that either support the inclusion or exclusion of an exon.</p>
<p>Below are examples of some RNAseq reads mapped along a transcript. This transcript contains exons (yellow) and introns (gray). Let’s say that there are two isoforms of this gene: one where <code>exon2</code> is included and one where it is exlcuded. Reads have been “aligned” to this transcript to give a graphical representation of where they came from. You can see that the orange, purple, blue, and teal reads all <em>support</em> the inclusion of <code>exon2</code>.</p>

<img data-src="../img/block-rna/junc_read.png" class="r-stretch quarto-figure-center"><p class="caption">Kim et al, Nat Methods, 2015</p></section>
<section id="split-alignments-1" class="slide level2 smaller">
<h2>Split alignments</h2>
<p>Another way to think about this is that the orange, purple, blue, and teal reads came from RNA molecules in which the transcript was included.</p>
<p>We know this because each of those reads cross a <strong>splice junction</strong> that is either <code>exon1-exon2</code> or <code>exon2-exon3</code>. These reads tell us, <strong>unambiguously</strong>, that <code>exon2</code> was included in the RNA molecule that these reads came from.</p>

<img data-src="../img/block-rna/junc_read.png" class="r-stretch quarto-figure-center"><p class="caption">Kim et al, Nat Methods, 2015</p><blockquote>
<p>What does the red read tell us? What would a read that unambiguously told us that exon2 was <em>excluded</em> look like?</p>
</blockquote>
</section>
<section id="strategy-in-action" class="slide level2 smaller">
<h2>Strategy in action</h2>
<p>Example of reads mapped to the area surrounding an alternative exon (the middle exon). The height of the red and blue area corresponds to the number of read coverage. The red and blue lines connecting exons represent the number of reads that span that junction. So for the blue condition, there are 347 reads (91 + 256) that support the inclusion of this exon, while 81 reads support its exclusion. In the red condition, this exon is less often excluded as 296 reads (65 + 231) support its inclusion while 130 support its exclusion. <em>Think about how often an exon was included in a sample as a ratio between the inclusion- and exclusion-supporting reads</em>.</p>

<img data-src="../img/block-rna/sashimi.png" style="width:50.0%" class="r-stretch"></section>
<section id="workflow" class="slide level2 smaller">
<h2>Workflow</h2>
<p>We will focus on the right side of the flowchart that relies on <a href="https://github.com/alexdobin/STAR"><code>STAR</code></a>, a splice-aware read aligner, and <a href="https://rnaseq-mats.sourceforge.io/"><code>rMATS</code></a>, an alternative splicing analysis tool.</p>

<img data-src="../img/block-rna/flowchart.png" class="r-stretch"></section>
<section id="how-star-works" class="slide level2 smaller">
<h2>How STAR works</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>STAR begins by finding matches (either unique or nonunique) between a portion of a read and the reference. This matching region of the query is extended along the reference until the two start to disagree. If this match extends all the way through to the end of the read, then the read lies completely within one exon (or intron, or I guess intergenic region if you are bad at making RNAseq libraries) and we are done. If the match ends before the end of the read, the part that has matched so far defines one <em>seed</em>.</p>
</div><div class="column" style="width:50%;">
<p><img data-src="../img/block-rna/seed1.png"></p>
</div></div>
</section>
<section id="how-star-works-1" class="slide level2 smaller">
<h2>How STAR works</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>STAR then takes the rest of the query and uses it to find the best match to its sequence in the reference, defining another seed.</p>
</div><div class="column" style="width:50%;">
<p><img data-src="../img/block-rna/seed2.png"></p>
</div></div>
</section>
<section id="how-star-works-2" class="slide level2 smaller">
<h2>How STAR works</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>If, during the extension of a match a small region of mismatch or discontinuity occurs, these can be identified as mutations or indels if high-quality matches between the query and reference resume later in the read.</p>
</div><div class="column" style="width:50%;">
<p><img data-src="../img/block-rna/indel.png" style="width:50.0%;height:100.0%"></p>
</div></div>
</section>
<section id="how-star-works-3" class="slide level2 smaller">
<h2>How STAR works</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>After aligning seeds, they can be stitched together. The stitching of seeds with high alignment quality (low number of indels, mismatches) is prefered over the stitching of seeds with low alignment quality (high number of indels, mismatches).</p>
</div><div class="column" style="width:50%;">
<p><img data-src="../img/block-rna/stitch.png"></p>
</div></div>
</section>
<section id="running-star" class="slide level2 smaller">
<h2>Running STAR</h2>
<p>To align reads, we first need to create an <strong>index</strong> of the genome (see STAR manual <a href="https://physiology.med.cornell.edu/faculty/skrabanek/lab/angsd/lecture_notes/STARmanual.pdf">here</a>. To do this, <code>STAR</code> will require the sequence of the genome (in fasta format), and an annotation that tells it where exons and introns are. It needs the annotation to be able to see if seeds that it stitches together make sense with what we know about exon/intron structures that exist in the transcriptome. Let’s take a look at one of these genome annotation files.</p>
</section>
<section id="annotation-files" class="slide level2 smaller">
<h2>Annotation files</h2>
<p>The most common annotation files are <code>GTF</code> and <code>GFF</code> files. Here’s an example of a <code>GFF</code>.</p>

<img data-src="../img/block-rna/gff.png" class="r-stretch"><p>Each line corresponds to one feature. This is a tab-delimited text file. There are only a few columns that we care about:</p>
<ul>
<li class="fragment">Column 1: chromosome</li>
<li class="fragment">Column 2: source</li>
<li class="fragment">Column 3: feature type</li>
<li class="fragment">Column 4: feature start</li>
<li class="fragment">Column 5: feature end</li>
<li class="fragment">Column 7: strand (you aren’t in DNA land anymore…strand matters)</li>
</ul>
</section>
<section id="annotation-files-1" class="slide level2 smaller">
<h2>Annotation files</h2>

<img data-src="../img/block-rna/gff.png" class="r-stretch"><p>Column 8 contains various information about the feature. Perhaps the most important one tells you about the hierarchy that defines the relationship between features. For example, genes contain <em>children</em> transcripts within them, and each transcript contains <em>children</em> exons. Transcripts will therefore belong to <em>parent</em> genes and exons will belong to <em>parent</em> transcripts. Biologically, this should make sense to you. These relationships are indicated by the <strong>Parent</strong> attribute within column 8.</p>
</section>
<section id="make-star-index" class="slide level2 smaller">
<h2>Make STAR index</h2>
<p>OK now we are ready to make our index. There relevant options we will need to pay attention to when doing this are shown below:</p>
<ul>
<li class="fragment"><strong>–runMode</strong> genomeGenerate (we are making an index, not aligning reads)</li>
<li class="fragment"><strong>–genomeDir</strong> /path/to/genomeDir (where you want STAR to put this index we are making)</li>
<li class="fragment"><strong>–genomeFastaFiles</strong> /path/to/genomesequence (genome sequence as fasta, either one file or multiple)</li>
<li class="fragment"><strong>–sjdbGTFfile</strong> /path/to/annotations.gff (yes it says gtf, but we are going to use a gff format)</li>
<li class="fragment"><strong>–sjdbOverhang</strong> 100 (100 will usually be a good value here, the recommended value is readLength - 1)</li>
<li class="fragment"><strong>–sjdbGTFtagExonParentTranscript</strong> Parent (we have to specify this because we are using a gff annotation and this is how gff files denote relationships)</li>
<li class="fragment"><strong>–genomeSAindexNbases</strong> 11 (don’t worry about this one, we are specifying it because we are using an artificially small genome in this example)</li>
</ul>
</section>
<section id="make-star-index-1" class="slide level2 smaller">
<h2>Make STAR index</h2>
<blockquote>
<p>STAR –runMode genomeGenerate –genomeDir {path-to}/mySTARindex –genomeFastaFiles {path-to}/genome.fasta –sjdbGTFfile {path-to}/MOLB7950.gff3 –sjdbOverhang 100 –sjdbGTFtagExonParentTranscript Parent –genomeSAindexNbases 11</p>
</blockquote>

<img data-src="../img/block-rna/star_index_out.png" class="r-stretch"></section>
<section id="star-align-reads" class="slide level2 smaller">
<h2>STAR: align reads</h2>
<p>Now that we have our index we are ready to align our reads. The options we need to pay attention to here are:</p>
<ul>
<li class="fragment"><strong>–runMode</strong> alignReads (we are aligning this time)</li>
<li class="fragment"><strong>–genomeDir</strong> /path/to/genomeDir (a path to the index we made in the previous step)</li>
<li class="fragment"><strong>–readFilesIn</strong> /path/to/forwardreads /path/to/reversereads (paths to our fastqs, separated by a space)</li>
<li class="fragment"><strong>–readFilesCommand</strong> gunzip -c (our reads our gzipped so we need to tell STAR how to read them)</li>
<li class="fragment"><strong>–outFileNamePrefix</strong> path/to/outputdir (where to put the results)</li>
<li class="fragment"><strong>–outSAMtype</strong> BAM SortedByCoordinate (the format of the alignment output, more on this later)</li>
</ul>
<p>Now we are ready to align our reads.</p>
</section>
<section id="star-align-reads-1" class="slide level2 smaller">
<h2>STAR: align reads</h2>
<blockquote>
<p>STAR –runMode alignReads –genomeDir {path-to}/mySTARindex/ –readFilesIn {path-to}/MOLB7950_1.fastq.gz {path-to}/MOLB7950_2.fastq.gz –readFilesCommand gunzip -c –outFileNamePrefix {path-to}/myalignments –outSAMtype BAM SortedByCoordinate</p>
</blockquote>

<img data-src="../img/block-rna/read_align_status.png" class="r-stretch"></section>
<section id="mapping-stats-produced-by-star" class="slide level2 smaller">
<h2>Mapping stats produced by STAR</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Well so how did it go? Check the log file. We can see that we put in almost 100k read pairs and 96.7k of these could be uniquely assigned to a single genomic position. 95.6k of these had a splice junction. This is expected for paired end reads against a genome with many introns and short exons.</p>
<p>As an aside, any read that aligns more times than is allowed by the flag <strong>–outFilterMultimapNmax</strong> is not reported in the alignments. As a default, this value is set to 10. Libraries that are made from low complexity RNA samples and those that deal with repetitive genomic regions can be sensitive to this. Also, if you wanted to, you can use this flag to restrict your alignment file to those that only <em>uniquely</em> aligned by setting this value to 1.</p>
</div><div class="column" style="width:50%;">
<p><img data-src="../img/block-rna/star_out.png"></p>
</div></div>
</section>
<section id="investigating-alignment-files" class="slide level2 smaller">
<h2>Investigating alignment files</h2>
<p>Our alignment output file is <code>dummyAligned.sortedByCoord.out.bam</code>. <code>BAM</code> files are binary files and need to be converted to plain text using <code>samtools view</code> for us to read it.</p>
<blockquote>
<p>samtools view dummyAligned.sortedByCoord.out.bam &gt; dummyAligned.sam</p>
</blockquote>
</section>
<section id="alignments" class="slide level2 smaller">
<h2>Alignments</h2>
<p>SAM files can be a little confusing, but it’s worth taking the time to get to know them. The full SAM format specification can be found <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">here</a>.</p>
<p>Let’s take a look at our SAM file and see what we see. I’m going to pick 2 lines out.</p>

<img data-src="../img/block-rna/sam_example.png" class="r-stretch"><p>Here we are looking at 2 lines from this file. These two lines correspond to two paired reads. I know that because the first field in this file is the read ID as it came off the sequencer. You can see that these two reads have the same ID (it’s the thing I grepped for).</p>
</section>
<section id="alignments-1" class="slide level2 smaller">
<h2>Alignments</h2>

<img data-src="../img/block-rna/sam_example.png" class="r-stretch"><p>The <strong>second</strong> field is a bitwise flag. It is a sum of integers where each integer tells us something about the read. Every possible value of this flag is a unique combination of the informative integers. You can see what each of these integers are and what they mean in the <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">SAM format specification</a>. There is also a handy calculator that you can plug your value into and it will tell you what your flag means <a href="https://www.samformat.info/sam-format-flag">here</a>. If we put our first flag, 163, in there it tell us that this read is:</p>
<ul>
<li class="fragment">The second read in a mate pair (128)</li>
<li class="fragment">On the opposite strand of its mate pair (32)</li>
<li class="fragment">Is mapped and properly paired (2)</li>
<li class="fragment">Is paired (1)</li>
</ul>
<p>If you put the flag value for the second read into the calculator, what do you get?</p>
</section>
<section id="alignments-2" class="slide level2 smaller">
<h2>Alignments</h2>

<img data-src="../img/block-rna/sam_example.png" class="r-stretch"><p>The <strong>third</strong> field is obviously the reference name. No big mystery there. This read maps to chromosome 19.</p>
<p>The <strong>fourth</strong> field is the position on the reference that corresponds to the beginning of the query. This read starts to map to chr19 beginning at position 3371611. As a aside, positions reported in SAM files are 1-based, not 0-based.</p>
</section>
<section id="alignments-3" class="slide level2 smaller">
<h2>Alignments</h2>

<img data-src="../img/block-rna/sam_example.png" class="r-stretch"><p>The <strong>sixth</strong> field is called the CIGAR string. This is a string of characters that tells you a little bit about <em>how</em> the query aligns to the reference. Again, details can be found in the <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">SAM format specification</a>. The CIGAR string for the first read can be interpreted as follows:</p>
<ul>
<li class="fragment">The first 67 bases in the query align to the reference.</li>
<li class="fragment">There is then a gap in the reference of 3415 nt.</li>
<li class="fragment">Then the query starts to match again, and does so for the next 84 nt.</li>
</ul>
<p>These are paired end 151 nt reads, so it makes sense that 67 + 84 = 151.</p>
<p>In not so shocking news, the top read’s mate (the second read) also has a gap in the reference of 3415 nt. As you might have guessed, these reads are spanning the same intron, which you would expect reads from the same mate pair to do.</p>
</section>
<section id="alignments-4" class="slide level2 smaller">
<h2>Alignments</h2>
<p>The <strong>ninth</strong> field is the <em>template length</em>, abbreviated TLEN. This is the distance, in nt, from the beginning of one read in a pair to the end of it’s mate.</p>

<img data-src="../img/block-rna/tlen.png" class="r-stretch"><p>If you know a little bit about how RNAseq libraries are made, you might know that transcripts are fragmented, usually to lengths of 200-500 nt. Given that this read is stretching over 3 kb along the reference sequence, it’s a good bet that it is spanning an intron that is present in the reference but had been removed in the RNA molecule i.e.&nbsp;it was spliced out!</p>
</section>
<section id="workflow-1" class="slide level2 smaller">
<h2>Workflow</h2>
<p>Now that we have aligned with <code>STAR</code>, we can calculate exon inclusion with <code>rMATS</code>. As is often the case with bioinformatic tools, <code>rMATS</code> is not the only tool that you can use to look at alternative splicing, but it has been around for a while and has been thoroughly tested.</p>

<img data-src="../img/block-rna/flowchart.png" class="r-stretch"></section>
<section id="psi-psi-values" class="slide level2 smaller">
<h2>PSI (<span class="math inline">\(\psi\)</span>) values</h2>
<p>In many scenarios, splicing is quantified using a metric called PSI (Percent Spliced In), often shown as the greek letter <span class="math inline">\(\psi\)</span>, is a metric that asks what fraction of transcripts <em>contain</em> the exon or RNA sequence in question. Thus, <span class="math inline">\(\psi\)</span> values range from 0 (which would indicate that the exon is never included) to 1 (which would indicate that the exon is always included). <span class="math inline">\(\psi\)</span> can be estimated by counting the number of reads that unambiguously support the inclusion of the exon and the number of reads that unambiguously support exclusion of the exon.</p>
<p>For skipped “cassette” exons, these reads are diagrammed below:</p>

<img data-src="../img/block-rna/sepsi.jpg" class="r-stretch quarto-figure-center"><p class="caption">Shen et al, (2014). PNAS</p></section>
<section id="psi-psi-values-1" class="slide level2 smaller">
<h2>PSI (<span class="math inline">\(\psi\)</span>) values</h2>
<p>In this diagram, the exon in gray can either be included or skipped to produced two different transcript isoforms. Reads in red (I for inclusion) unambiguously argue for the inclusion of the exon while reads in green (S for skipping) unambiguously argue for skipping of the exon. Keep in mind that the reads drawn over splice junctions indicate the the read spans the splice junction.</p>

<img data-src="../img/block-rna/sepsi.jpg" class="r-stretch quarto-figure-center"><p class="caption">Shen et al, (2014). PNAS</p><blockquote>
<p>Note: Red reads that do not cross a junction but lie totally within the gray exon are often used in splicing analysis, but do not formally unambiguously show exon inclusion. It is safer to rely <strong>only</strong> on splice-junction spanning reads for splicing quantitation. The downside of this is that you will lose read counts that came from non-junction reads. Fewer read counts means less statistical power.</p>
</blockquote>
</section>
<section id="types-of-alternative-splicing" class="slide level2 smaller">
<h2>Types of alternative splicing</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../img/block-rna/astypes_1.png"></p>
<figcaption>Shen et al, (2014). PNAS</figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<p>There are other types of alternative splicing besides skipped exons. In each case, <span class="math inline">\(\psi\)</span> is defined as the fraction of transcript in which the white sequence is included.</p>
<p>Since we have already determined where in the genome RNAseq reads came from using <code>STAR</code>, we will now use <code>rMATS</code> to take those locations and combine it with information about the locations of alternative exons to quantify the inclusion of each alternative exon.</p>
</div></div>
</section>
<section id="running-rmats" class="slide level2 smaller">
<h2>Running rMATS</h2>
<p>To quantify alternative splicing, <code>rMATS</code> needs two things: the locations of the reads in the genome (bam files) and the locations of alternative exons in the genome (GTF annotation file).</p>
<blockquote>
<p>Note: You may remember that when we ran STAR, we used a different type of genome annotaiton file: GFF. GTFs and GFFs contain essentially the same information and it is possible to interconvert between the two. I chose to introduce you to GFFs because, to my mind, they are more intuitive to and readable by humans. STAR could handle both GTF and GFF formats. rMATS requires GTFs.</p>
</blockquote>
<p>Here are the most relevant options when running <code>rMATS</code>. See the documentation <a href="https://github.com/Xinglab/rmats-turbo/blob/v4.1.0/README.md">here</a>.</p>
<ul>
<li class="fragment"><strong>–b1</strong> /path/to/b1.txt (path to a text file that contains paths to all BAM files for samples in condition 1)</li>
<li class="fragment"><strong>–b2</strong> /path/to/b2.txt (path to a text file that contains paths to all BAM files for samples in condition 2)</li>
<li class="fragment"><strong>–gtf</strong> /path/to/gtf (path to the gtf genome annotation)</li>
<li class="fragment"><strong>-t</strong> readtype (single or paired)</li>
<li class="fragment"><strong>–readlength</strong> readlength</li>
<li class="fragment"><strong>–od</strong> /path/to/output (output directory)</li>
</ul>
</section>
<section id="looking-at-rmats-output" class="slide level2 smaller">
<h2>Looking at rMATS output</h2>
<p>In this example, the authors were interested in the splicing regulatory activity of the RNA-binding protein RBFOX2. They sequenced RNA from cells that had been treated with either shRNA against RBFOX2 or a control, non-targeting shRNA. Each condition was performed in quadruplicate, meaning we have 4 replicates for each condition. I downloaded their data, aligned it against the mouse genome using <code>STAR</code>, and then quantified alternative splicing using <code>rMATS</code>.</p>
<p>We won’t run <code>rMATS</code> here because we would need multiple large bam files to do anything meaningful, and honestly, it’s just copying things from the documentation and putting them into the command line. What we will do though, is look at the output produced by <code>rMATS</code>.</p>
</section>
<section id="rmats-output" class="slide level2 smaller">
<h2>rMATS output</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>You can see that there are many files here, and that each type of alternative splicing (A3SS, A5SS, MXE, RI, and SE) has files associated with it. Specifically each event type has 2 files: one that ends in ‘JC.txt’ and one that ends in ‘JCEC.txt’. The ‘JC.txt’ files only use reads that cross splice junctions to quantify splicing (JC = junction counts) while the ‘JCEC.txt’ files use both junction reads <em>and</em> reads that map to the alternative exon (EC = exon counts). We are going to use the files ending in <code>*JC.txt</code>.</p>
</div><div class="column" style="width:50%;">
<p><img data-src="../img/block-rna/rmats_dir.png"></p>
</div></div>
</section>
<section id="rmats-output-1" class="slide level2 smaller">
<h2>rMATS output</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>If we look at <code>SE.MATS.JC.txt</code> file the column names are at the top. Let’s go through some of the more important columns:</p>
<ul>
<li class="fragment"><strong>ID</strong> A unique identifier for this event.</li>
<li class="fragment"><strong>chr</strong> chromosome</li>
<li class="fragment"><strong>strand</strong> strand (+ or -)</li>
<li class="fragment"><strong>exonStart_0base</strong> the coordinate of the beginning of the alternative exon (using 0-based coordinates)</li>
<li class="fragment"><strong>exonEnd</strong> the coordinate of the end of the alternative exon</li>
</ul>
</div><div class="column" style="width:60%;">
<p><img data-src="../img/block-rna/rmats_out.png"></p>
</div></div>
</section>
<section id="rmats-output-2" class="slide level2 smaller">
<h2>rMATS output</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li class="fragment"><strong>upstreamES</strong> the coordinate of the beginning of the exon immediately upstream of the alternative exon</li>
<li class="fragment"><strong>upstreamEE</strong> the coordinate of the end of the exon immediately upstream of the alternative exon</li>
<li class="fragment"><strong>downstreamES</strong> the coordinate of the beginning of the exon immediately downstream of the alternative exon</li>
<li class="fragment"><strong>downstreamEE</strong> the coordinate of the end of the exon immediately downstream of the alternative exon</li>
</ul>
</div><div class="column" style="width:60%;">
<p><img data-src="../img/block-rna/rmats_out.png"></p>
</div></div>
</section>
<section id="rmats-output-3" class="slide level2 smaller">
<h2>rMATS output</h2>
<p>Notice that with these coordinates and the sequence of the genome, you could derive the sequences flanking each of these exons. That could be useful, perhaps, if you wanted to ask if there were short sequences (kmers) enriched near exons whose inclusion was sensitive to RBFOX2 loss versus exons whose inclusion was insensitive.</p>
<ul>
<li class="fragment"><strong>IJC_SAMPLE_X</strong> the number of read counts that support inclusion of the exon is sample X (four numbers, one for each replicate, each separated by a comma)</li>
<li class="fragment"><strong>SJC_SAMPLE_X</strong> same thing, but for read counts that support the exclusion of the exon</li>
</ul>
</section>
<section id="rmats-output-4" class="slide level2 smaller">
<h2>rMATS output</h2>
<p>The numbers from <code>[S|I]JC_SAMPLE_X</code> could be useful for filtering events based on coverage. Say, for example, that we were looking at an event that when we combined IJC and SJC counts for each replicate we got something like 2,4,1,5. That would mean that in the replicates for this condition, we only had 2, 4, 1, and 5 reads that tell us anything about the status of this exon. That’s pretty low, so I would argue that we really wouldn’t want to consider this event at all since we don’t have much confidence that we know anything about its inclusion.</p>
<ul>
<li class="fragment"><strong>PValue</strong> The pvalue asking if the PSI values for this event between the two conditions is statistically significantly different</li>
<li class="fragment"><strong>FDR</strong> The p value, after it has been corrected for multiple hypothesis testing. This is the significance value you would want to filter on.</li>
<li class="fragment"><strong>IncLevel1</strong> PSI values for the replicates in condition 1 (in this case, condition 1 is RBFOX shRNA).</li>
<li class="fragment"><strong>IncLevel2</strong> PSI values for the replicates in condition 2 (in this case, condition 2 is Control shRNA).</li>
<li class="fragment"><strong>IncLevelDifference</strong> Difference in PSI values between conditions (Condition 1 - Condition 2).</li>
</ul>
</section>
<section id="rmats-output-5" class="slide level2 smaller">
<h2>rMATS output</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>psis <span class="ot">&lt;-</span></span>
<span id="cb1-2"><a></a>  <span class="fu">read_tsv</span>(</span>
<span id="cb1-3"><a></a>    <span class="fu">here</span>(<span class="st">"data/block-rna/rMATS/SE.MATS.JC.txt.gz"</span>),</span>
<span id="cb1-4"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-5"><a></a>  <span class="co"># Select only the columns we care about</span></span>
<span id="cb1-6"><a></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb1-7"><a></a>    <span class="fu">c</span>(</span>
<span id="cb1-8"><a></a>      <span class="at">ID =</span> ID...<span class="dv">1</span>,</span>
<span id="cb1-9"><a></a>      geneSymbol,</span>
<span id="cb1-10"><a></a>      <span class="fu">contains</span>(<span class="st">"SAMPLE"</span>),</span>
<span id="cb1-11"><a></a>      FDR,</span>
<span id="cb1-12"><a></a>      <span class="fu">starts_with</span>(<span class="st">"Inc"</span>)</span>
<span id="cb1-13"><a></a>    )</span>
<span id="cb1-14"><a></a>  )</span>
<span id="cb1-15"><a></a></span>
<span id="cb1-16"><a></a>psis</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12,134 × 11
      ID geneSymbol IJC_SAMPLE_1   SJC_SAMPLE_1 IJC_SAMPLE_2
   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt;       
 1     5 Neil1      12,6,9,5       0,0,0,0      10,8,14,0   
 2     6 Wrap53     44,34,40,22    3,0,0,0      29,13,19,15 
 3     9 Zfp28      3,0,0,4        0,0,0,0      2,0,0,0     
 4    11 Pik3cd     18,5,1,3       0,0,0,0      3,7,10,2    
 5    17 Cd81       348,210,261,2… 0,0,0,0      231,166,135…
 6    21 Smarca4    136,107,135,78 0,0,1,0      107,132,95,…
 7    22 Smarca4    8,0,0,8        148,93,102,… 1,0,0,4     
 8    26 Map7d1     3,1,11,10      9,3,26,8     8,14,7,23   
 9    27 Map7d1     3,1,7,7        0,0,2,0      8,16,5,19   
10    28 Ubxn2a     62,70,49,38    1,4,4,0      51,54,52,20 
# ℹ 12,124 more rows
# ℹ 6 more variables: SJC_SAMPLE_2 &lt;chr&gt;, FDR &lt;dbl&gt;,
#   IncFormLen &lt;dbl&gt;, IncLevel1 &lt;chr&gt;, IncLevel2 &lt;chr&gt;,
#   IncLevelDifference &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We will only consider events where there are <em>at least</em> 20 informative reads that tell us about the inclusion of the exon <code>IJC + SJC &gt; 20</code> in <strong>every replicate</strong>. For example, for event ‘5’ (gene Neil1) above, Sample 1 replicates have 12, 6, 9, and 5 reads while Sample 2 replicates have 10, 8, 14, and 0 reads. I would want to require that all of 12, 6, 9, 5, 10, 8, 14, and 0 are greater than 20 in order to worry about this event. Otherwise, I conclude that we don’t have enough data to accurately conclude anything about this event.</p>
</section>
<section id="tidy-rmats-output" class="slide level2 smaller">
<h2>tidy rMATS output</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>psis <span class="ot">&lt;-</span> psis <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a></a>  <span class="fu">separate_wider_delim</span>(</span>
<span id="cb3-3"><a></a>    <span class="at">cols =</span> <span class="fu">c</span>(IJC_SAMPLE_1, SJC_SAMPLE_1, IJC_SAMPLE_2, SJC_SAMPLE_2),</span>
<span id="cb3-4"><a></a>    <span class="at">delim =</span> <span class="st">","</span>,</span>
<span id="cb3-5"><a></a>    <span class="at">names_sep =</span> <span class="st">""</span>,</span>
<span id="cb3-6"><a></a>    <span class="at">too_few =</span> <span class="st">"align_start"</span></span>
<span id="cb3-7"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-8"><a></a>  <span class="fu">rename_with</span>(</span>
<span id="cb3-9"><a></a>    \(x) {</span>
<span id="cb3-10"><a></a>      <span class="fu">case_when</span>(</span>
<span id="cb3-11"><a></a>        <span class="fu">str_detect</span>(x, <span class="st">"IJC_SAMPLE_1_(</span><span class="sc">\\</span><span class="st">d+)"</span>) <span class="sc">~</span></span>
<span id="cb3-12"><a></a>          <span class="fu">str_replace</span>(x, <span class="st">"IJC_SAMPLE_1_(</span><span class="sc">\\</span><span class="st">d+)"</span>, <span class="st">"IJC_S1R</span><span class="sc">\\</span><span class="st">1"</span>),</span>
<span id="cb3-13"><a></a>        <span class="fu">str_detect</span>(x, <span class="st">"SJC_SAMPLE_1_(</span><span class="sc">\\</span><span class="st">d+)"</span>) <span class="sc">~</span></span>
<span id="cb3-14"><a></a>          <span class="fu">str_replace</span>(x, <span class="st">"SJC_SAMPLE_1_(</span><span class="sc">\\</span><span class="st">d+)"</span>, <span class="st">"SJC_S1R</span><span class="sc">\\</span><span class="st">1"</span>),</span>
<span id="cb3-15"><a></a>        <span class="fu">str_detect</span>(x, <span class="st">"IJC_SAMPLE_2_(</span><span class="sc">\\</span><span class="st">d+)"</span>) <span class="sc">~</span></span>
<span id="cb3-16"><a></a>          <span class="fu">str_replace</span>(x, <span class="st">"IJC_SAMPLE_2_(</span><span class="sc">\\</span><span class="st">d+)"</span>, <span class="st">"IJC_S2R</span><span class="sc">\\</span><span class="st">1"</span>),</span>
<span id="cb3-17"><a></a>        <span class="fu">str_detect</span>(x, <span class="st">"SJC_SAMPLE_2_(</span><span class="sc">\\</span><span class="st">d+)"</span>) <span class="sc">~</span></span>
<span id="cb3-18"><a></a>          <span class="fu">str_replace</span>(x, <span class="st">"SJC_SAMPLE_2_(</span><span class="sc">\\</span><span class="st">d+)"</span>, <span class="st">"SJC_S2R</span><span class="sc">\\</span><span class="st">1"</span>),</span>
<span id="cb3-19"><a></a>        <span class="at">.default =</span> x</span>
<span id="cb3-20"><a></a>      )</span>
<span id="cb3-21"><a></a>    }</span>
<span id="cb3-22"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb3-23"><a></a>  <span class="co"># Convert to numeric</span></span>
<span id="cb3-24"><a></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"IJC_"</span>, <span class="st">"SJC_"</span>)), as.numeric))</span>
<span id="cb3-25"><a></a></span>
<span id="cb3-26"><a></a>psis</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12,134 × 23
      ID geneSymbol IJC_SAMPLE_11 IJC_SAMPLE_12
   &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;
 1     5 Neil1                 12             6
 2     6 Wrap53                44            34
 3     9 Zfp28                  3             0
 4    11 Pik3cd                18             5
 5    17 Cd81                 348           210
 6    21 Smarca4              136           107
 7    22 Smarca4                8             0
 8    26 Map7d1                 3             1
 9    27 Map7d1                 3             1
10    28 Ubxn2a                62            70
# ℹ 12,124 more rows
# ℹ 19 more variables: IJC_SAMPLE_13 &lt;dbl&gt;,
#   IJC_SAMPLE_14 &lt;dbl&gt;, SJC_SAMPLE_11 &lt;dbl&gt;,
#   SJC_SAMPLE_12 &lt;dbl&gt;, SJC_SAMPLE_13 &lt;dbl&gt;,
#   SJC_SAMPLE_14 &lt;dbl&gt;, IJC_SAMPLE_21 &lt;dbl&gt;,
#   IJC_SAMPLE_22 &lt;dbl&gt;, IJC_SAMPLE_23 &lt;dbl&gt;,
#   IJC_SAMPLE_24 &lt;dbl&gt;, SJC_SAMPLE_21 &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="filter-rmats-output" class="slide level2 smaller">
<h2>filter rMATS output</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>psis_filt <span class="ot">&lt;-</span> psis <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a></a>    <span class="at">S1R1counts =</span> IJC_SAMPLE_11 <span class="sc">+</span> SJC_SAMPLE_11,</span>
<span id="cb5-4"><a></a>    <span class="at">S1R2counts =</span> IJC_SAMPLE_12 <span class="sc">+</span> SJC_SAMPLE_12,</span>
<span id="cb5-5"><a></a>    <span class="at">S1R3counts =</span> IJC_SAMPLE_13 <span class="sc">+</span> SJC_SAMPLE_13,</span>
<span id="cb5-6"><a></a>    <span class="at">S1R4counts =</span> IJC_SAMPLE_14 <span class="sc">+</span> SJC_SAMPLE_14,</span>
<span id="cb5-7"><a></a>    <span class="at">S2R1counts =</span> IJC_SAMPLE_21 <span class="sc">+</span> SJC_SAMPLE_21,</span>
<span id="cb5-8"><a></a>    <span class="at">S2R2counts =</span> IJC_SAMPLE_22 <span class="sc">+</span> SJC_SAMPLE_22,</span>
<span id="cb5-9"><a></a>    <span class="at">S2R3counts =</span> IJC_SAMPLE_23 <span class="sc">+</span> SJC_SAMPLE_23,</span>
<span id="cb5-10"><a></a>    <span class="at">S2R4counts =</span> IJC_SAMPLE_24 <span class="sc">+</span> SJC_SAMPLE_24</span>
<span id="cb5-11"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-12"><a></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(<span class="fu">ends_with</span>(<span class="st">"counts"</span>), <span class="sc">~</span> .x <span class="sc">&gt;=</span> <span class="dv">20</span>))</span>
<span id="cb5-13"><a></a></span>
<span id="cb5-14"><a></a><span class="fu">head</span>(psis_filt)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 31
     ID geneSymbol IJC_SAMPLE_11 IJC_SAMPLE_12 IJC_SAMPLE_13
  &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1    17 Cd81                 348           210           261
2    21 Smarca4              136           107           135
3    22 Smarca4                8             0             0
4    28 Ubxn2a                62            70            49
5    95 Wbp2                 125           105           150
6    98 Eme1                  50            55            68
# ℹ 26 more variables: IJC_SAMPLE_14 &lt;dbl&gt;,
#   SJC_SAMPLE_11 &lt;dbl&gt;, SJC_SAMPLE_12 &lt;dbl&gt;,
#   SJC_SAMPLE_13 &lt;dbl&gt;, SJC_SAMPLE_14 &lt;dbl&gt;,
#   IJC_SAMPLE_21 &lt;dbl&gt;, IJC_SAMPLE_22 &lt;dbl&gt;,
#   IJC_SAMPLE_23 &lt;dbl&gt;, IJC_SAMPLE_24 &lt;dbl&gt;,
#   SJC_SAMPLE_21 &lt;dbl&gt;, SJC_SAMPLE_22 &lt;dbl&gt;,
#   SJC_SAMPLE_23 &lt;dbl&gt;, SJC_SAMPLE_24 &lt;dbl&gt;, FDR &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="plot-distribution-of-psi-values" class="slide level2 smaller">
<h2>Plot distribution of PSI values</h2>
<p>Exons whose inclusion is not regulated tend to have PSI values that are either very close to 0 or very close to 1 (i.e.&nbsp;these exons are pretty much always included or always skipped). Exons whose inclusion is regulated tend to have PSI values that are more evenly spread between 0 and 1. Do see this in our data?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>psis_filt_psi <span class="ot">&lt;-</span> psis_filt <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a></a>  <span class="fu">separate_wider_delim</span>(</span>
<span id="cb7-3"><a></a>    <span class="at">col =</span> IncLevel1,</span>
<span id="cb7-4"><a></a>    <span class="at">delim =</span> <span class="st">","</span>,</span>
<span id="cb7-5"><a></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"PSI_S1R1"</span>, <span class="st">"PSI_S1R2"</span>, <span class="st">"PSI_S1R3"</span>, <span class="st">"PSI_S1R4"</span>)</span>
<span id="cb7-6"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-7"><a></a>  <span class="fu">separate_wider_delim</span>(</span>
<span id="cb7-8"><a></a>    <span class="at">col =</span> IncLevel2,</span>
<span id="cb7-9"><a></a>    <span class="at">delim =</span> <span class="st">","</span>,</span>
<span id="cb7-10"><a></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"PSI_S2R1"</span>, <span class="st">"PSI_S2R2"</span>, <span class="st">"PSI_S2R3"</span>, <span class="st">"PSI_S2R4"</span>)</span>
<span id="cb7-11"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-12"><a></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"PSI"</span>), FDR) <span class="sc">|&gt;</span></span>
<span id="cb7-13"><a></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"PSI"</span>), as.numeric))</span>
<span id="cb7-14"><a></a></span>
<span id="cb7-15"><a></a><span class="co"># Turn data from wide format into long format for plotting purposes</span></span>
<span id="cb7-16"><a></a>psis_filt_psi_long <span class="ot">&lt;-</span> psis_filt_psi <span class="sc">|&gt;</span></span>
<span id="cb7-17"><a></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb7-18"><a></a>    <span class="at">cols =</span> PSI_S1R1<span class="sc">:</span>PSI_S2R4,</span>
<span id="cb7-19"><a></a>    <span class="at">names_to =</span> <span class="st">"sample"</span>,</span>
<span id="cb7-20"><a></a>    <span class="at">values_to =</span> <span class="st">"psi"</span></span>
<span id="cb7-21"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-22"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-23"><a></a>    <span class="at">condition =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(sample, <span class="st">"S1"</span>), <span class="st">"RBFOX2kd"</span>, <span class="st">"Controlkd"</span>),</span>
<span id="cb7-24"><a></a>    <span class="at">sig =</span> <span class="fu">if_else</span>(FDR <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>)</span>
<span id="cb7-25"><a></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="co"># Plot</span></span>
<span id="cb8-2"><a></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DarkOrange"</span>, <span class="st">"DarkViolet"</span>)</span>
<span id="cb8-3"><a></a></span>
<span id="cb8-4"><a></a><span class="fu">ggplot</span>(</span>
<span id="cb8-5"><a></a>  psis_filt_psi_long,</span>
<span id="cb8-6"><a></a>  <span class="fu">aes</span>(</span>
<span id="cb8-7"><a></a>    <span class="at">x =</span> psi,</span>
<span id="cb8-8"><a></a>    <span class="at">linetype =</span> condition,</span>
<span id="cb8-9"><a></a>    <span class="at">color =</span> sig</span>
<span id="cb8-10"><a></a>  )</span>
<span id="cb8-11"><a></a>) <span class="sc">+</span></span>
<span id="cb8-12"><a></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb8-13"><a></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb8-14"><a></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb8-15"><a></a>    <span class="sc">~</span>sig,</span>
<span id="cb8-16"><a></a>    <span class="at">scales =</span> <span class="st">"free_y"</span>,</span>
<span id="cb8-17"><a></a>    <span class="at">nrow =</span> <span class="dv">2</span></span>
<span id="cb8-18"><a></a>  ) <span class="sc">+</span></span>
<span id="cb8-19"><a></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

</section>
<section id="plot-distribution-of-psi-values-output" class="slide level2 smaller output-location-slide"><h2>Plot distribution of PSI values</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides-25_files/figure-revealjs/plot-psis-2-1.png" width="960"></p>
</figure>
</div>
</div>
</div></section><section id="plot-distribution-of-psi-values-output" class="slide level2 smaller output-location-slide"><h2>Plot distribution of PSI values</h2><div class="cell output-location-slide">

</div></section><section id="pca-of-psi-values" class="slide level2 smaller">
<h2>PCA of PSI values</h2>
<p>Just as we did with gene expression values, we can monitor the quality of this data using principle components analysis. We would expect that replicates within a condition would be clustered next to each other in this analysis and that PC1, the principal component along which the majority of the variance lies, would separate the conditions.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="co"># Make a matrix of psi values</span></span>
<span id="cb9-2"><a></a>psis_mtx <span class="ot">&lt;-</span></span>
<span id="cb9-3"><a></a>  <span class="fu">select</span>(psis_filt_psi, <span class="sc">-</span>FDR) <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a></a>  <span class="fu">drop_na</span>()</span>
<span id="cb9-5"><a></a></span>
<span id="cb9-6"><a></a><span class="co"># Use prcomp() to derive principle component coordinants of PSI values</span></span>
<span id="cb9-7"><a></a>psi_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(psis_mtx))</span>
<span id="cb9-8"><a></a></span>
<span id="cb9-9"><a></a><span class="co"># Add annotations of the conditions to the samples</span></span>
<span id="cb9-10"><a></a>psi_pca_pc <span class="ot">&lt;-</span></span>
<span id="cb9-11"><a></a>  <span class="fu">data.frame</span>(</span>
<span id="cb9-12"><a></a>    psi_pca<span class="sc">$</span>x,</span>
<span id="cb9-13"><a></a>    <span class="at">sample =</span> <span class="fu">colnames</span>(psis_mtx)</span>
<span id="cb9-14"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb9-15"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-16"><a></a>    <span class="at">condition =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-17"><a></a>      <span class="fu">grepl</span>(<span class="st">"S1"</span>, sample) <span class="sc">~</span> <span class="st">"RBFOX2kd"</span>,</span>
<span id="cb9-18"><a></a>      <span class="at">.default =</span> <span class="st">"Controlkd"</span></span>
<span id="cb9-19"><a></a>    )</span>
<span id="cb9-20"><a></a>  ) </span>
<span id="cb9-21"><a></a></span>
<span id="cb9-22"><a></a></span>
<span id="cb9-23"><a></a><span class="co"># Get the amount of variances contained within PC1 and PC2</span></span>
<span id="cb9-24"><a></a>psi.pca.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(psi_pca)<span class="sc">$</span>importance</span>
<span id="cb9-25"><a></a>pc1var <span class="ot">&lt;-</span> <span class="fu">round</span>(psi.pca.summary[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb9-26"><a></a>pc2var <span class="ot">&lt;-</span> <span class="fu">round</span>(psi.pca.summary[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb9-27"><a></a></span>
<span id="cb9-28"><a></a><span class="co"># Plot PCA data</span></span>
<span id="cb9-29"><a></a><span class="fu">ggplot</span>(</span>
<span id="cb9-30"><a></a>  psi_pca_pc,</span>
<span id="cb9-31"><a></a>  <span class="fu">aes</span>(</span>
<span id="cb9-32"><a></a>    <span class="at">x =</span> PC1,</span>
<span id="cb9-33"><a></a>    <span class="at">y =</span> PC2,</span>
<span id="cb9-34"><a></a>    <span class="at">shape =</span> condition,</span>
<span id="cb9-35"><a></a>    <span class="at">color =</span> condition</span>
<span id="cb9-36"><a></a>  )</span>
<span id="cb9-37"><a></a>) <span class="sc">+</span></span>
<span id="cb9-38"><a></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb9-39"><a></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb9-40"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb9-41"><a></a>    <span class="at">x =</span> <span class="fu">paste</span>(<span class="st">"PC1,"</span>, pc1var, <span class="st">"% explained var."</span>),</span>
<span id="cb9-42"><a></a>    <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"PC2,"</span>, pc2var, <span class="st">"% explained var."</span>)</span>
<span id="cb9-43"><a></a>  ) <span class="sc">+</span></span>
<span id="cb9-44"><a></a>  <span class="fu">theme_cowplot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

</section>
<section id="pca-of-psi-values-output" class="slide level2 smaller output-location-slide"><h2>PCA of PSI values</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides-25_files/figure-revealjs/pca-psis-1.png" alt="Description of the plot - PLEASE FILL IN" width="960"></p>
</figure>
</div>
</div>
</div></section><section id="heatmap-of-psi-events" class="slide level2">
<h2>Heatmap of psi events</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="co"># Filter only significant events</span></span>
<span id="cb10-2"><a></a>psi_sig <span class="ot">&lt;-</span> psis_filt_psi <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a></a>  <span class="fu">filter</span>(FDR <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a></a>  <span class="fu">select</span>(<span class="sc">-</span>FDR)</span>
<span id="cb10-5"><a></a></span>
<span id="cb10-6"><a></a><span class="co"># row scaled heatmap</span></span>
<span id="cb10-7"><a></a><span class="fu">pheatmap</span>(</span>
<span id="cb10-8"><a></a>  <span class="at">mat =</span> psi_sig,</span>
<span id="cb10-9"><a></a>  <span class="at">clustering_method =</span> <span class="st">"ward.D2"</span>,</span>
<span id="cb10-10"><a></a>  <span class="at">scale =</span> <span class="st">"row"</span>,</span>
<span id="cb10-11"><a></a>  <span class="at">show_rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb10-12"><a></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>



</section>
    <section id="heatmap-of-psi-events-output" class="slide level2 output-location-slide"><h2>Heatmap of psi events</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="slides-25_files/figure-revealjs/heatmap-psis-1.png" width="960"></p>
</figure>
</div>
</div>
</div></section></div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="https://rnabioco.github.io/molb-7950">Course 🔗</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/rnabioco\.github\.io\/molb-7950\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>